#!/bin/bash

# ─────────────────────────────────────────────────────────────
# Semakan kebenaran langganan (remote whitelist)
# ─────────────────────────────────────────────────────────────
PERM_LIB="/opt/connectifyvpn/lib/permission.sh"
if [[ -f "$PERM_LIB" ]]; then
  # shellcheck disable=SC1090
  source "$PERM_LIB"
  permission_check_or_exit "/opt/connectifyvpn"
else
  echo "Ralat: fail permission.sh tidak dijumpai. Sila jalankan installer dahulu."
  exit 1
fi

Green="\e[92;1m"
RED="\033[31m"
YELLOW="\033[33m"
BLUE="\033[36m"
FONT="\033[0m"
GREENBG="\033[42;37m"
REDBG="\033[41;37m"
OK="${Green}--->${FONT}"
ERROR="${RED}[ERROR]${FONT}"
GRAY="\e[1;30m"
NC='\e[0m'
red='\e[1;31m'
green='\e[0;32m'
DF='\e[39m'
Bold='\e[1m'
g="\033[1;92m"
y='\033[1;33m' #yellow
Blink='\e[5m'
yell='\e[33m'
red='\e[31m'
green='\e[32m'
blue='\e[34m'
PURPLE='\e[35m'
cyan='\e[36m'
Lred='\e[91m'
Lgreen='\e[92m'
Lyellow='\e[93m'
NC='\e[0m'
GREEN='\033[0;32m'
ORANGE='\033[0;33m'
LIGHT='\033[0;37m'
grenbo="\e[92;1m"
red() { echo -e "\\033[32;1m${*}\\033[0m"; }
# Getting
UDPX="https://docs.google.com/uc?export=download&confirm=$(wget --quiet --save-cookies /tmp/cookies.txt --keep-session-cookies --no-check-certificate 'https://docs.google.com/uc?export=download&id=1S3IE25v_fyUfCLslnujFBSBMNunDHDk2' -O- | sed -rn 's/.*confirm=([0-9A-Za-z_]+).*/\1\n/p')&id=1S3IE25v_fyUfCLslnujFBSBMNunDHDk2"
export CHATID=""
export KEY=""
export TIME="10"
export URL="https://api.telegram.org/bot$KEY/sendMessage"
clear
#IZIN SCRIPT
MYIP=$(curl -sS ipv4.icanhazip.com)
echo -e "\e[32mloading...\e[0m"
clear
# Valid Script
#data_ip="https://abc.xcodehoster.com/izin"
echo -e "\e[32mloading...\e[0m"
clear
#Domain
domain=$(cat /etc/xray/domain)

echo -e " ${y}  ┌───────────────────────────────┐$NC"
echo -e " ${y}  │${NC}${g}.::.${NC} OTHER SETTING MENU ${g}.::. $NC"
echo -e " ${y}  └───────────────────────────────┘$NC"
echo -e    "\033[1;33m  ┌──────────────────────────────────────────┐\033[0m"
echo -e "  ${y}│${NC}${g} 01.${NC}\033[0;36m Backup/Restor${NC}"
echo -e "  ${y}│${NC}${g} 02.${NC}\033[0;36m SPEEDTEST${NC}"
echo -e "  ${y}│${NC}${g} 03.${NC}\033[0;36m VPS INFO${NC}"
echo -e "  ${y}│${NC}${g} 04.${NC}\033[0;36m RESTART SERVICE${NC}"
echo -e "  ${y}│${NC}${g} 05.${NC}\033[0;36m REBOOT${NC}"
echo -e "  ${y}│${NC}${g} 06.${NC}\033[0;36m RUNNING SERVICE ${NC}"
echo -e "  ${y}│${NC}${g} 07.${NC}\033[0;36m CLEARLOG${NC}"
echo -e "  ${y}│${NC}${g} 08.${NC}\033[0;36m DELETE USER EXP${NC}"
echo -e "  ${y}│${NC}${g} 09.${NC}\033[0;36m EDIT BENNER${NC}"
echo -e "  ${y}│${NC}${g} 10.${NC}\033[0;36m CHANGE DOMAIN${NC}"
echo -e "  ${y}│${NC}${g} 11.${NC}\033[0;36m CERT SSL/DOMAIN${NC}"
echo -e "  ${y}│${NC}${g} 12.${NC}\033[0;36m INFO PORT${NC}"
echo -e "  ${y}│${NC}${g} 13.${NC}\033[0;36m AUTO REBOOT${NC}"
echo -e "  ${y}│${NC}${g} 14.${NC}\033[0;36m CLEAR CHACE${NC}"
echo -e "  ${y}│${NC}${g} 15.${NC}\033[0;36m INS UDP${NC}"
echo -e "  ${y}│${NC}"
echo -e "  ${y}│${NC}${g} x.${NC}\033[0;36m Back To Menu ${NC}"
echo -e "\033[1;33m  └──────────────────────────────────────────┘\033[0m"
read -p "Select From Options [ 1 - 14 ] : " menu
echo -e ""
case $menu in
1)
    mbot
    ;;
2)
    speedtest
    ;;
3)
    gotop
    ;;
4)
    restart
    ;;
5)
    reboot
    ;;
6)
    run
    ;;
7)
    clear
    clearlog
    ;;
8)
    clear
    xp
    ;;
9)
    nano /etc/connectifyvpn.txt  
    ;;
10)
    addhost
    ;;    
11)
    fixcert
    ;;
12)
    clear
    prot
    ;;
13)
    autoreboot
    ;;
14)
    clear
    clearcache
    ;;
15) 
    clear
    wget --load-cookies /tmp/cookies.txt ${UDPX} -O install-udp && rm -rf /tmp/cookies.txt && chmod +x install-udp && ./install-udp
    ;;
x)
    clear
    menu
    ;;
esac
